<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Courier POD Terminal</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body {
    background: black;
    color: #00ff00;
    font-family: monospace;
    font-weight: bold;
    margin: 0;
    padding: 5px;
}
#terminal {
    white-space: pre;
    line-height: 1.2em;
    font-size: 12px;
    min-height: 250px;
}
input.cmd, button.cmd {
    background: black;
    color: #00ff00;
    border: 1px solid #00ff00;
    width: 100%;
    font-family: monospace;
    font-weight: bold;
    font-size: 12px;
    outline: none;
    padding: 2px;
    margin-top: 4px;
}
button.cmd {
    cursor: pointer;
}
</style>
</head>
<body>

<div id="terminal">
Courier POD Terminal v1.0
Type UserID to login:
&gt;
</div>

<input type="text" id="cmdInput" class="cmd" autocomplete="off">
<button class="cmd" onclick="submitInput()">ENTER</button>

<script>
var terminal = document.getElementById('terminal');
var input = document.getElementById('cmdInput');

var API = "https://script.google.com/macros/s/AKfycbyuNEpOksgP5xs_wdTBBv3MLPle_dFltxLhYI3F1ieVl97oQLZ-b7ZrGYklCh1FYKLnNA/exec"; // replace with your Apps Script URL

var session = {
    loggedIn: false,
    waitingPass: false,
    userid: "",
    passid: "",
    trk: "",
    service: "STANDARD"
};

function println(txt) {
    terminal.innerHTML += txt + "\n&gt;";
    window.scrollTo(0, document.body.scrollHeight);
}

function submitInput() {
    var val = input.value.trim();
    input.value = "";
    processInput(val);
}

// Process user input
function processInput(val){
    if(val=="") return;

    // Login flow
    if(!session.loggedIn){
        if(!session.waitingPass){
            session.userid = val;
            println("UserID entered. Now enter PassID:");
            session.waitingPass = true;
            return;
        } else {
            session.passid = val;
            session.loggedIn = true;
            session.waitingPass = false;
            println("Logged in as "+session.userid);
            println("Enter Tracking ID:");
            return;
        }
    }

    // Tracking ID
    if(!session.trk){
        session.trk = val;
        println("TRK: "+session.trk);
        println("Select Status: A=Accepted, T=In Transit, O=Out for Delivery, DL=Delivered");
        return;
    }

    // Status selection
    var status = val.toUpperCase();
    if(["A","T","O","DL"].indexOf(status) >= 0){
        var note = prompt("Enter Note (optional)","");
        var signature = "";
        if(status=="DL"){
            signature = prompt("Enter Signature if EXPRESS","");
        }

        // Send to server
        var xhr = new XMLHttpRequest();
        xhr.open("POST", API, true);
        xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
        xhr.onreadystatechange = function(){
            if(xhr.readyState==4){
                println("Server response: " + xhr.responseText);
                println("Enter next Tracking ID:");
                session.trk = "";
            }
        };
        var data = "userid="+encodeURIComponent(session.userid)+
                   "&passid="+encodeURIComponent(session.passid)+
                   "&trk="+encodeURIComponent(session.trk)+
                   "&status="+encodeURIComponent(status)+
                   "&note="+encodeURIComponent(note)+
                   "&signature="+encodeURIComponent(signature);
        xhr.send(data);
        return;
    }

    println("Invalid input. Type status: A, T, O, DL");
}

// Force focus on input (old devices)
window.onload = function(){ setTimeout(function(){ input.focus(); },500); };
</script>

</body>
</html>
