<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Courier POD Terminal</title>
<style>
body{background:black;color:#00ff00;font-family:monospace;font-weight:bold;padding:5px;margin:0}
#terminal{white-space:pre;line-height:1.2em;font-size:12px;min-height:250px}
input.cmd{background:black;color:#00ff00;border:none;width:100%;font-family:monospace;font-weight:bold;font-size:12px;outline:none}
select.cmd{background:black;color:#00ff00;border:1px solid #00ff00;font-family:monospace;font-weight:bold;font-size:12px}
</style>
</head>
<body>

<div id="terminal">
Courier POD Terminal v1.0
Type UserID to login:
&gt;
</div>

<input type="text" id="cmdInput" class="cmd" autocomplete="off">

<script>
var terminal=document.getElementById('terminal');
var input=document.getElementById('cmdInput');

var API="https://script.google.com/macros/s/AKfycbyuNEpOksgP5xs_wdTBBv3MLPle_dFltxLhYI3F1ieVl97oQLZ-b7ZrGYklCh1FYKLnNA/exec"; // old Android HTTP
var session={loggedIn:false,userid:"",trk:"",service:"STANDARD"};

function println(txt){ terminal.innerHTML+=txt+"\n&gt;"; window.scrollTo(0,document.body.scrollHeight); }

input.onkeypress=function(e){
    if(!e) e=window.event;
    if(e.keyCode==13){
        var val=input.value;
        input.value="";
        processInput(val);
        return false;
    }
}

function processInput(val){
    val=val.trim();
    if(val=="") return;

    if(!session.loggedIn){
        session.userid=val;
        println("UserID entered. Now enter PassID:");
        session.loggedIn="pass"; // waiting for password
        return;
    }

    if(session.loggedIn=="pass"){
        session.passid=val;
        session.loggedIn=true;
        println("Logged in as "+session.userid);
        println("Enter Tracking ID:");
        return;
    }

    if(!session.trk){
        session.trk=val;
        println("TRK: "+session.trk);
        println("Select Status: A=Accepted, T=In Transit, O=Out for Delivery, DL=Delivered");
        return;
    }

    if(["A","T","O","DL"].indexOf(val.toUpperCase())>=0){
        var status=val.toUpperCase();
        var note=prompt("Enter Note (optional)","");
        var signature="";
        if(status=="DL"){
            signature=prompt("Enter Signature if EXPRESS",""); // simple prompt for signature
        }

        // send to server
        var xhr=new XMLHttpRequest();
        xhr.open("POST",API,true);
        xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
        xhr.onreadystatechange=function(){if(xhr.readyState==4){println(xhr.responseText+"\nEnter next TRK:"); session.trk="";}};
        var data="userid="+encodeURIComponent(session.userid)+
                 "&passid="+encodeURIComponent(session.passid)+
                 "&trk="+encodeURIComponent(session.trk)+
                 "&status="+encodeURIComponent(status)+
                 "&note="+encodeURIComponent(note)+
                 "&signature="+encodeURIComponent(signature);
        xhr.send(data);
        return;
    }

    println("Invalid input. Enter status: A,T,O,DL");
}
</script>

</body>
</html>
